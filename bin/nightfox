#!/bin/bash

source "$(dirname "$0")"/lib/util.sh

neph="$(dirname "$(readlink -f "$0")")/.."

parse_args nightfox 'g' '' "$@"
eval app_args=("$(get_args)")

export MOZ_USE_OMTC=1
export JS_DISABLE_SLOW_SCRIPT_SIGNALS=1

# export MOZ_PROFILER_NEW=1
# export MOZ_PROFILER_VERBOSE=1
# export MOZ_PROFILER_INTERVAL=10
# export MOZ_PROFILER_MODE=combined
# export MOZ_PROFILER_STACK_SCAN=0

if [ -n "$(get_option g)" ]; then
  cmd cd ~/firefox-nightly
  cmd cleangtk gdb -ex run \
                   --args ./firefox "${app_args[@]}"
else
  cmd cleangtk ~/firefox-nightly/firefox "${app_args[@]}"
fi
